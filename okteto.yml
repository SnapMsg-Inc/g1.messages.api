name: g1.posts.api

build:
  posts-api:
    context: .

deploy:
   - helm upgrade --install messages-ms chart
     --set api.image=${OKTETO_BUILD_MESSAGES_API_IMAGE}

dev:
  posts-api:
    command: ddtrace-run uvicorn src.main:app --host 0.0.0.0 --port 3002 --reload
    forward:
      - 3000:3000
      - 27017:messages-db:27017
      - 8126:datadog-agent:8126
    sync:
      - .:/usr/snapmsg-messages
